<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<!-- saved from url=(0084)https://chromium.googlesource.com/chromium/src/+/master/tools/gn/docs/style_guide.md -->
<html class="doc-page"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><title>GN Style Guide</title><link rel="stylesheet" type="text/css" href="./GN Style Guide_files/doc.0L3SNFV84koi7_B276HAQw.cache.css"><link rel="stylesheet" type="text/css" href="./GN Style Guide_files/prettify.pZ5FqzM6cPxAflH0va2Ucw.cache.css"></head><body><div class="doc"><h1><a class="h" name="GN-Style-Guide" href="https://chromium.googlesource.com/chromium/src/+/master/tools/gn/docs/style_guide.md#GN-Style-Guide"><span></span></a>GN Style Guide</h1><div class="toc" role="navigation"><h2>Contents</h2><div class="toc-aux"><ul><li><a href="https://chromium.googlesource.com/chromium/src/+/master/tools/gn/docs/style_guide.md#Naming-and-ordering-within-the-file">Naming and ordering within the file</a></li><ul><li><a href="https://chromium.googlesource.com/chromium/src/+/master/tools/gn/docs/style_guide.md#Location-of-build-files">Location of build files</a></li><li><a href="https://chromium.googlesource.com/chromium/src/+/master/tools/gn/docs/style_guide.md#Targets">Targets</a></li><li><a href="https://chromium.googlesource.com/chromium/src/+/master/tools/gn/docs/style_guide.md#Configs">Configs</a></li><li><a href="https://chromium.googlesource.com/chromium/src/+/master/tools/gn/docs/style_guide.md#Example">Example</a></li></ul><li><a href="https://chromium.googlesource.com/chromium/src/+/master/tools/gn/docs/style_guide.md#Ordering-within-a-target">Ordering within a target</a></li><ul><li><a href="https://chromium.googlesource.com/chromium/src/+/master/tools/gn/docs/style_guide.md#Conditions">Conditions</a></li></ul><li><a href="https://chromium.googlesource.com/chromium/src/+/master/tools/gn/docs/style_guide.md#Formatting-and-indenting">Formatting and indenting</a></li><ul><li><a href="https://chromium.googlesource.com/chromium/src/+/master/tools/gn/docs/style_guide.md#List-formatting">List formatting</a></li><li><a href="https://chromium.googlesource.com/chromium/src/+/master/tools/gn/docs/style_guide.md#Sources">Sources</a></li><li><a href="https://chromium.googlesource.com/chromium/src/+/master/tools/gn/docs/style_guide.md#Deps">Deps</a></li><li><a href="https://chromium.googlesource.com/chromium/src/+/master/tools/gn/docs/style_guide.md#Import">Import</a></li></ul><li><a href="https://chromium.googlesource.com/chromium/src/+/master/tools/gn/docs/style_guide.md#Usage">Usage</a></li></ul></div></div><h2><a class="h" name="Naming-and-ordering-within-the-file" href="https://chromium.googlesource.com/chromium/src/+/master/tools/gn/docs/style_guide.md#Naming-and-ordering-within-the-file"><span></span></a>Naming and ordering within the file</h2><h3><a class="h" name="Location-of-build-files" href="https://chromium.googlesource.com/chromium/src/+/master/tools/gn/docs/style_guide.md#Location-of-build-files"><span></span></a>Location of build files</h3><p>It usually makes sense to have more build files closer to the code than fewer ones at the toplevel (this is in contrast with what we did with GYP). This makes things easier to find and owners reviews easier since changes are more focused.</p><h3><a class="h" name="Targets" href="https://chromium.googlesource.com/chromium/src/+/master/tools/gn/docs/style_guide.md#Targets"><span></span></a>Targets</h3><ul><li>Most BUILD files should have a target with the same name of the directory. This target should be the first target.</li><li>Other targets should be in “some order that makes sense.” Usually more important targets will be first, and unit tests will follow the corresponding target. If there’s no clear ordering, consider alphabetical order.</li><li>Test support libraries should be source sets named “test_support”. So “//ui/compositor:test_support”. Test support libraries should include as public deps the non-test-support version of the library so tests need only depend on the test_support target (rather than both).</li></ul><p>Naming advice</p><ul><li>Targets and configs should be named using lowercase with underscores separating words, unless there is a strong reason to do otherwise.</li><li>Source sets, groups, and static libraries do not need globally unique names. Prefer to give such targets short, non-redundant names without worrying about global uniqueness. For example, it looks much better to write a dependency as <code>"//mojo/public/bindings"</code> rather than `“//mojo/public/bindings:mojo_bindings”</li><li>Shared libraries (and by extension, components) must have globally unique output names. Give such targets short non-unique names above, and then provide a globally unique <code>output_name</code> for that target.</li><li>Executables and tests should be given a globally unique name. Technically only the output names must be unique, but since only the output names appear in the shell and on bots, it’s much less confusing if the name matches the other places the executable appears.</li></ul><h3><a class="h" name="Configs" href="https://chromium.googlesource.com/chromium/src/+/master/tools/gn/docs/style_guide.md#Configs"><span></span></a>Configs</h3><ul><li>A config associated with a single target should be named the same as the target with <code>_config</code> following it.</li><li>A config should appear immediately before the corresponding target that uses it.</li></ul><h3><a class="h" name="Example" href="https://chromium.googlesource.com/chromium/src/+/master/tools/gn/docs/style_guide.md#Example"><span></span></a>Example</h3><p>Example for the <code>src/foo/BUILD.gn</code> file:</p><pre class="code"># Copyright 2013 The Chromium Authors. All rights reserved.
# Use of this source code is governed by a BSD-style license that can be
# found in the LICENSE file.

# Config for foo is named foo_config and immediately precedes it in the file.
config("foo_config") {
}

# Target matching path name is the first target.
executable("foo") {
}

# Test for foo follows it.
test("foo_unittests") {
}

config("bar_config") {
}

source_set("bar") {
}
</pre><h2><a class="h" name="Ordering-within-a-target" href="https://chromium.googlesource.com/chromium/src/+/master/tools/gn/docs/style_guide.md#Ordering-within-a-target"><span></span></a>Ordering within a target</h2><ol><li><code>output_name</code> / <code>visibility</code> / <code>testonly</code></li><li><code>sources</code></li><li><code>cflags</code>, <code>include_dirs</code>, <code>defines</code>, <code>configs</code> etc. in whatever  order makes sense to you.</li><li><code>public_deps</code></li><li><code>deps</code></li></ol><h3><a class="h" name="Conditions" href="https://chromium.googlesource.com/chromium/src/+/master/tools/gn/docs/style_guide.md#Conditions"><span></span></a>Conditions</h3><p>Simple conditions affecting just one variable (e.g. adding a single source or adding a flag for one particular OS) can go beneath the variable they affect. More complicated conditions affecting more than one thing should go at the bottom.</p><p>Conditions should be written to minimize the number of conditional blocks.</p><h2><a class="h" name="Formatting-and-indenting" href="https://chromium.googlesource.com/chromium/src/+/master/tools/gn/docs/style_guide.md#Formatting-and-indenting"><span></span></a>Formatting and indenting</h2><ul><li>Indents are two spaces, both for indented blocks and wrapped lines.</li><li>Variables are <code>lower_case_with_underscores</code></li><li>Complicated conditions and if statements should generally follow the Google C++ style guide for formatting.</li><li>Comments should be complete sentences with periods at the end.</li><li>End-of-line-comments should have two spaces separating them and the code.</li><li>Compiler flags and such should always be commented with what they do and why the flag is needed.</li><li>Try to keep lines under 80 columns. If a file name or similar string puts you beyond 80 with reasonable indenting, it’s OK, but most things can be wrapped nicely under that for the code review tool.</li></ul><h3><a class="h" name="List-formatting" href="https://chromium.googlesource.com/chromium/src/+/master/tools/gn/docs/style_guide.md#List-formatting"><span></span></a>List formatting</h3><pre class="code">  deps = [
    "afile.cc",
    "bar.cc",  # Note trailing comma on last element.
  ]
</pre><p>Alphabetize the list elements unless there is a more obvious ordering. In some cases, it makes more sense to put more than one list member on a line if they clearly go together (for example, two short compiler flags that must go next to each other).</p><p>Prefer use the multi-line style for lists of more than one elements. Lists with single-elements can be written on one line if desired:</p><pre class="code">  all_dependent_configs = [ ":foo_config" ]  # No trailing comma.
</pre><h3><a class="h" name="Sources" href="https://chromium.googlesource.com/chromium/src/+/master/tools/gn/docs/style_guide.md#Sources"><span></span></a>Sources</h3><ul><li>Sources should always be alphabetized within a given list.</li><li>List sources only once. It is OK to conditionally include sources rather than listing them all at the top and then conditionally excluding them when they don’t apply. Conditional inclusion is often clearer since a file is only listed once and it’s easier to reason about when reading.</li></ul><pre class="code">  sources = [
    "main.cc",
  ]
  if (use_aura) {
    sources += [ "thing_aura.cc" ]
  }
  if (use_gtk) {
    sources += [ "thing_gtk.cc" ]
  }
</pre><h3><a class="h" name="Deps" href="https://chromium.googlesource.com/chromium/src/+/master/tools/gn/docs/style_guide.md#Deps"><span></span></a>Deps</h3><ul><li>Deps should be in alphabetical order.</li><li>Deps within the current file should be written first and not qualified with the file name (just <code>:foo</code>).</li><li>Other deps should always use fully-qualified path names unless relative ones are required for some reason.</li></ul><pre class="code">  deps = [
    ":a_thing",
    ":mystatic",
    "//foo/bar:other_thing",
    "//foo/baz:that_thing",
  ]
</pre><h3><a class="h" name="Import" href="https://chromium.googlesource.com/chromium/src/+/master/tools/gn/docs/style_guide.md#Import"><span></span></a>Import</h3><p>Use fully-qualified paths for imports:</p><pre class="code">import("//foo/bar/baz.gni")  # Even if this file is in the foo/bar directory
</pre><h2><a class="h" name="Usage" href="https://chromium.googlesource.com/chromium/src/+/master/tools/gn/docs/style_guide.md#Usage"><span></span></a>Usage</h2><p>Use <code>source_set</code> rather than <code>static_library</code> unless you have a reason to do otherwise. A static library is a standalone library which can be slow to generate. A source set just links all the object files from that target into the targets depending on it, which saves the “lib” step.</p></div><div class="footer-break"></div><div class="footer-line"><div class="nav-aux"><ul><li><a href="https://chromium.googlesource.com/chromium/src/+show/master/tools/gn/docs/style_guide.md">source</a></li><li><a href="https://chromium.googlesource.com/chromium/src/+log/master/tools/gn/docs/style_guide.md">log</a></li><li><a href="https://chromium.googlesource.com/chromium/src/+blame/master/tools/gn/docs/style_guide.md">blame</a></li></ul><div class="gitiles-att">Powered by <a href="https://code.google.com/p/gitiles/">Gitiles</a></div></div></div><script async="" src="./GN Style Guide_files/analytics.js"></script><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o), m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','//www.google-analytics.com/analytics.js','ga'); ga('create', 'UA-55762617-15', 'auto'); ga('send', 'pageview', {title: 'GN Style Guide'});</script></body></html>